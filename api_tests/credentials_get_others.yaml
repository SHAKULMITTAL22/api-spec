# ********RoostGPT********
# Test generated by RoostGPT for test api-test using AI Type Open AI and AI Model gpt-4
# 
# ================================VULNERABILITIES================================
# Vulnerability: Insecure Direct Object References (IDOR)
# Issue: GET requests to /credentials and /credentials/497f6eca-6276-4993-bfeb-53cbbbba6f08. If unauthorized users can access this endpoint, it could potentially expose sensitive information (e.g., user credentials).
# Solution: Implement proper access control checks to prevent unauthorized access. Ensure sensitive data is properly protected (e.g., encryption). Also, consider using indirect references instead of exposing direct references to internal implementation objects.
# 
# ================================================================================
# Test generated for /credentials_get for http method type GET in artillery framework
# RoostTestHash=c5011f3c64
# 
# 
# ********RoostGPT********
config:
  target: "{{ $processEnvironment.API_HOST }}"
  plugins:
    expect: {}
  payload:
    path: "credentials_get_others.csv"
    fields:
      - "Token"
    skipHeader: true
  phases:
    - duration: 60
      arrivalRate: 20

scenarios:
  - name: "Non-success API responses test scenario"
    flow:
      - get:
          url: "/wrongcredentials?size={{ size }}&offset={{ offset }}"
          headers:
            Token: "{{$processEnvironment.AUTH_TOKEN}}"
      - expect:
          - statusCode: 404
          - hasProperty: "message"
      - equals:
          - "message"
          - "Invalid URL"
      - think: 1
      - get:
          url: "/credentials?size=51&offset={{ offset }}"
          headers:
            Token: "{{$processEnvironment.AUTH_TOKEN}}"
      - expect:
          - statusCode: 400
          - hasProperty: "message"
      - equals:
          - "message"
          - "Size parameter is out of range"
      - think: 1
      - get:
          url: "/credentials?size={{ size }}&offset=-1"
          headers:
            Token: "{{$processEnvironment.AUTH_TOKEN}}"
      - expect:
          - statusCode: 400
          - hasProperty: "message"
      - equals:
          - "message"
          - "Offset parameter is out of range"
      - think: 1
      - get:
          url: "/credentials?size={{ size }}&offset={{ offset }}"
          headers:
            Token: "wrongtoken"
      - expect:
          - statusCode: 401
          - hasProperty: "message"
      - equals:
          - "message"
          - "Unauthorized access"
      - think: 1
