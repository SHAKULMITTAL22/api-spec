# ********RoostGPT********
# Test generated by RoostGPT for test api-test using AI Type Open AI and AI Model gpt-4
# 
# ================================VULNERABILITIES================================
# Vulnerability: Potential Information Disclosure
# Issue: Repeated access to '/credentials' and '/credentials/497f6eca-6276-4993-bfeb-53cbbbba6f08' endpoints. These endpoints may contain sensitive information.
# Solution: Ensure these endpoints are secured with appropriate authentication and authorization controls. Consider implementing rate limiting to prevent brute force attacks. Regularly review and update access logs to detect any unauthorized access attempts.
# 
# ================================================================================
# Test generated for /credentials_get for http method type GET in artillery framework
# RoostTestHash=c5011f3c64
# 
# 
# ********RoostGPT********
config:
  target: "{{ $processEnvironment.API_HOST }}"
  plugins:
    expect: {}
  payload:
    path: "credentials_get_success.csv"
    fields:
      - "size"
      - "offset"
    skipHeader: true

scenarios:
  - name: "Test successful API responses"
    flow:
      - get:
          url: "/credentials?size={{ size }}&offset={{ offset }}"
          headers:
            Token: "{{$processEnvironment.AUTH_TOKEN}}"
          expect:
            - statusCode: 200
            - hasProperty: "credentials"
            - hasProperty: "total"
      - think: 1
      - get:
          url: "/credentials?size={{ size }}&offset={{ offset }}"
          headers:
            Token: "{{$processEnvironment.AUTH_TOKEN}}"
          expect:
            - hasHeader: "api-version"
            - headerEquals: {"api-version": "1.0.0"}
            - hasHeader: "page-size"
            - hasHeader: "page-offset"
      - think: 1
      - get:
          url: "/credentials/{{ id }}"
          headers:
            Token: "{{$processEnvironment.AUTH_TOKEN}}"
          expect:
            - statusCode: 200
            - hasProperty: "id"
            - hasProperty: "format"
            - hasProperty: "credential"
            - hasProperty: "status"
            - hasProperty: "statusUpdatedAt"
            - hasProperty: "createdAt"
      - think: 1
