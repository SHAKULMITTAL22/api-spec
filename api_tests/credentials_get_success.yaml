# ********RoostGPT********
# Test generated by RoostGPT for test api-test using AI Type Open AI and AI Model gpt-4
# 
# ================================VULNERABILITIES================================
# Vulnerability: Potential Unauthorized Access Attempt
# Issue: Multiple GET requests to /credentials endpoint detected in the logs at 5:04:32 AM, 5:05:22 AM and 5:05:43 AM. This could suggest an attempt to access sensitive information.
# Solution: Monitor the source of these requests to determine if they are legitimate. Implement rate limiting on sensitive endpoints to prevent potential brute force attacks. Ensure that access to this endpoint is properly authenticated and logged for audit purposes.
# 
# ================================================================================
# Test generated for /credentials_get for http method type GET in artillery framework
# RoostTestHash=c5011f3c64
# 
# 
# ********RoostGPT********
config:
  target: "{{ $processEnvironment.API_HOST }}"
  plugins:
    expect: {}
  payload:
    path: "credentials_get_success.csv"
    fields:
      - "size"
      - "offset"
    skipHeader: true

scenarios:
  - name: "Validate successful API responses"
    flow:
      - get:
          url: "/credentials?size={{ size }}&offset={{ offset }}"
          headers:
            Token: "{{ $processEnvironment.AUTH_TOKEN }}"
      - expect:
          statusCode: 200
      - expect:
          hasProperty: "credentials"
      - expect:
          hasProperty: "total"
      - expect:
          hasHeader: "api-version"
      - expect:
          headerEquals: {"api-version": "1.0.0"}
      - expect:
          hasHeader: "page-size"
      - expect:
          hasHeader: "page-offset"
      - expect:
          contentType: "application/json"
      - expect:
          equals:
            - "credentials[0].id": "{{ id }}"
            - "credentials[0].format": "{{ format }}"
            - "credentials[0].credential": "{{ credential }}"
            - "credentials[0].status": "{{ status }}"
            - "credentials[0].statusUpdatedAt": "{{ statusUpdatedAt }}"
            - "credentials[0].createdAt": "{{ createdAt }}"
      - capture:
          json: "$.credentials[0]"
          as: "credentials"
      - think: 2
