# ********RoostGPT********
# Test generated by RoostGPT for test api-test using AI Type Open AI and AI Model gpt-4
# 
# ================================VULNERABILITIES================================
# Vulnerability: Insecure Direct Object References (IDOR)
# Issue: The log indicates a deletion of credentials with a specific ID (497f6eca-6276-4993-bfeb-53cbbbba6f08). While this doesn't directly reveal a vulnerability, it could potentially be exploited if an attacker can manipulate these references (line 1)
# Solution: Implement access controls to ensure that only authorized users can delete credentials. Also, consider using indirect references instead of actual IDs to prevent potential IDOR attacks
# 
# ================================================================================
# Test generated for /credentials/{id}_delete for http method type DELETE in artillery framework
# RoostTestHash=f1fc1d06f7
# 
# 
# ********RoostGPT********
config:
  target: "{{ $processEnvironment.API_HOST }}" # Target API host is being set by the environment variable API_HOST
  phases:
    - duration: 60 # Test will run for 60 seconds
      arrivalRate: 20 # 20 virtual users will be created every second
  plugins:
    expect: {} # Expect plugin is used for assertions
  payload:
    path: "credentials_id_delete_success.csv" # CSV file path which contains data for the test
    fields:
      - "id" # Field in the CSV file
    skipHeader: true # Skip the header in the CSV file

scenarios:
  - name: "Delete one credential from my Wallet" # Scenario name
    flow:
      - delete: # HTTP DELETE request
          url: "/credentials/{{ id }}" # URL for the DELETE request, id is being set from the CSV file
          headers:
            Token: "{{ $processEnvironment.AUTH_TOKEN }}" # Auth token is being set by the environment variable AUTH_TOKEN
          expect: # Assertions
            - statusCode: 200 # Expecting status code to be 200
            - hasHeader: "api-version" # Expecting header to contain "api-version"
            - headerEquals: { "api-version": "1.0.0" } # Expecting "api-version" to be "1.0.0"
      - think: 1 # Pause for 1 second before the next flow
