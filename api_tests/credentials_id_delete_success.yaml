# ********RoostGPT********
# Test generated by RoostGPT for test api-test using AI Type Open AI and AI Model gpt-4
# 
# ================================VULNERABILITIES================================
# Vulnerability:Insecure Direct Object References (IDOR)
# Issue: The log indicates a deletion operation on a resource with the id '497f6eca-6276-4993-bfeb-53cbbbba6f08'. If proper access controls are not in place, this could lead to an Insecure Direct Object References (IDOR) vulnerability. This is because the id seems to be directly used in the operation without checking if the requester has the necessary permissions to perform this operation.
# Solution: Implement proper access controls. Before performing any operation on a resource, ensure that the requester has the necessary permissions to perform the operation. This can be done by maintaining an access control list for each resource or by implementing role-based access control.
# 
# ================================================================================
# # Test generated for /credentials/{id}_delete for http method type DELETE in artillery framework
# # RoostTestHash=f1fc1d06f7
# 
# 
# ********RoostGPT********
config:
  target: "{{ $processEnvironment.API_HOST }}"
  phases:
    - duration: 60
      arrivalRate: 20
  payload:
    path: "credentials_id_delete_success.csv"
    fields:
      - "id"
  plugins:
    expect: {}
  headers:
    Token: "{{ $processEnvironment.AUTH_TOKEN }}"

scenarios:
  - name: "Delete one credential from my Wallet"
    flow:
      # Delete a credential
      - delete:
          url: "/credentials/{{ id }}"
          headers:
            Token: "{{ $processEnvironment.AUTH_TOKEN }}"
          expect:
            - statusCode: 200
            - hasHeader: "api-version"
            - headerEquals: {"api-version": "1.0.0"}
      # Think time
      - think: 1
